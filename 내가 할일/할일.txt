테이블 선택시 새로운 모달창 생성에서
수정 삭제

2번째 화면은 

재고 관리 페이지 만들기

거래 내역 나오는 페이지

0=미판매 수량 -1
1=판매중 
2=품절 = 0



CREATE TABLE finishedgoodsinventory(
	FINISHEDGOODSINVENTORY_ID NUMBER(20,0),
	FINISHEDGOODSINVENTORY_GOODS_ID NUMBER(20,0),
	FINISHEDGOODSINVENTORY_GOODS_NAME VARCHAR2(200),
	FINISHEDGOODSINVENTORY_quantity NUMBER(20,0),
	FINISHEDGOODSINVENTORY_DIVISION VARCHAR2(2CHAR),
	FINISHEDGOODSINVENTORY_DATE DATE
);

INSERT INTO FINISHEDGOODS VALUES (finishedgoods_seq.nextval,'양념 치킨',0,13500,'1kg');
INSERT INTO FINISHEDGOODS VALUES (finishedgoods_seq.nextval,'후라이드 치킨',0,13500,'1kg');
INSERT INTO FINISHEDGOODS VALUES (finishedgoods_seq.nextval,'반반 치킨',0,13500,'1kg');
INSERT INTO FINISHEDGOODS VALUES (finishedgoods_seq.nextval,'이상한 치킨',0,13500,'1kg',0);


SELECT RECIPE_NAME FROM RECIPE r ;


SELECT RECIPE_NAME FROM recipe r, finishedgoods f WHERE r.RECIPE_NAME != f.FINISHEDGOODS_NAME;

(SELECT RECIPE_NAME AS finishedgoods_name
FROM RECIPE)
minus
(SELECT FINISHEDGOODS_NAME 
FROM FINISHEDGOODS);

SELECT FINISHEDGOODS_NAME 
FROM FINISHEDGOODS 
WHERE FINISHEDGOODS_STATUS=0;

SELECT 
rn,
FINISHEDGOODS_ID, 
FINISHEDGOODS_NAME, 
FINISHEDGOODS_QUANTITY, 
FINISHEDGOODS_PRICE, 
QUANTITY_UNITS,
FINISHEDGOODS_STATUS
FROM 
(SELECT /*+ INDEX_ASC(FINISHEDGOODS SYS_C0012608)*/ rownum rn,
FINISHEDGOODS_ID, 
FINISHEDGOODS_NAME, 
FINISHEDGOODS_QUANTITY, 
FINISHEDGOODS_PRICE, 
QUANTITY_UNITS,
FINISHEDGOODS_STATUS
FROM FINISHEDGOODS
WHERE FINISHEDGOODS_NAME LIKE '%'||''||'%' 
--AND FINISHEDGOODS_STATUS=0
AND rownum <= 2*3)
WHERE rn > (2-1)*3
;

SELECT count(*)
FROM FINISHEDGOODS
WHERE FINISHEDGOODS_NAME LIKE '%'||''||'%'
AND FINISHEDGOODS_STATUS=0;

UPDATE FINISHEDGOODS 
SET FINISHEDGOODS_STATUS = 1, FINISHEDGOODS_PRICE =2500, QUANTITY_UNITS ='' 
WHERE FINISHEDGOODS_NAME = '';


DELETE FROM FINISHEDGOODS WHERE FINISHEDGOODS_ID = 번호;

INSERT INTO FINISHEDGOODSSTORAGE 
VALUES(FINISHEDGOODSSTORAGE_SEQ.NEXTVAL, '경기도 남양주시 진접읍 팔야리 592-1', '(주)창구식품', 0, 500);


CREATE SEQUENCE FINISHEDGOODSSTORAGE_SEQ
INCREMENT BY 1
START WITH 120000
MAXVALUE 129999
NOCYCLE
NOCACHE;


INSERT INTO FINISHEDGOODSSTORAGE 
VALUES(FINISHEDGOODSSTORAGE_SEQ.NEXTVAL, '경기 이천시 백사면 이여로 352-19', 
'한일식품 창고', 0, 600);

SELECT * 
FROM FINISHEDGOODSSTORAGE
WHERE STORAGE_NAME LIKE '%%'
AND STORAGE_CURRENT_AMOUNT<STORAGE_TOTAL_AMOUNT
ORDER BY STORAGE_ID OFFSET (1-1)*3 ROWS FETCH NEXT 3 ROW ONLY
;

SELECT COUNT(*)
FROM FINISHEDGOODSSTORAGE;

DELETE FROM FINISHEDGOODSSTORAGE WHERE STORAGE_ID = 번호;

SELECT * FROM FINISHEDGOODSINVENTORY;

SELECT *
FROM FINISHEDGOODSSTORAGE 
WHERE STORAGE_CURRENT_AMOUNT < STORAGE_TOTAL_AMOUNT;

UPDATE FINISHEDGOODSSTORAGE 
SET STORAGE_ADDRESS = '' , STORAGE_TOTAL_AMOUNT = 600 
WHERE STORAGE_ID = 120002;

SELECT * FROM FINISHEDGOODSINVENTORY;

--제품 추가 시 필요한 것
--제품에 없으면 추가
INSERT INTO FINISHEDGOODS(FINISHEDGOODS_ID,FINISHEDGOODS_NAME,QUANTITY_UNITS, RECIPE_ID) 
VALUES (finishedgoods_seq.nextval,(SELECT RECIPE_NAME FROM RECIPE WHERE RECIPE.RECIPE_ID = 30216),'1kg', 30216);

--없는 제품 조회
SELECT RECIPE_ID
FROM RECIPE r
WHERE NOT EXISTS (SELECT 1 
		FROM FINISHEDGOODS f  
		WHERE r.RECIPE_ID=f.RECIPE_ID)
;
--레시피 와 제품에 있으면 수정 상태, 가격, 단위


--제품에만 있으면 삭제
DELETE FROM FINISHEDGOODS f
WHERE 
NOT EXISTS (SELECT 1 
FROM RECIPE r 
WHERE f.RECIPE_ID =r.RECIPE_ID);

--입고 시 필요한 것
INSERT INTO FINISHEDGOODSINVENTORY 
VALUES (7, 80061, '처갓집양념치킨', 100, '입고', '2024-04-17', 120007);
UPDATE FINISHEDGOODSSTORAGE 
SET STORAGE_CURRENT_AMOUNT = STORAGE_CURRENT_AMOUNT+600 
WHERE STORAGE_ID = 120005;
	

SELECT 
STORAGE_ID ,STORAGE_NAME,
CASE WHEN EXISTS(SELECT 1 
FROM FINISHEDGOODSSTORAGE F1 
WHERE STORAGE_CURRENT_AMOUNT<STORAGE_TOTAL_AMOUNT 
AND STORAGE_TOTAL_AMOUNT-STORAGE_CURRENT_AMOUNT < 200
AND F1.STORAGE_ID = F2.STORAGE_ID) THEN '가능' END AS proposition
FROM FINISHEDGOODSSTORAGE F2;


SELECT FINISHEDGOODS_ID, FINISHEDGOODS_NAME 
FROM FINISHEDGOODS 
WHERE FINISHEDGOODS_STATUS=1
;


SELECT 
	FINISHEDGOODSINVENTORY_STORAGE, 
	(SELECT STORAGE_NAME 
	FROM FINISHEDGOODSSTORAGE s 
	WHERE s.STORAGE_ID =i.FINISHEDGOODSINVENTORY_STORAGE) AS storage_name,
	SUM(FINISHEDGOODSINVENTORY_QUANTITY) AS finishedgoodsinventory_quantity
FROM 
	FINISHEDGOODSINVENTORY i
WHERE 
	FINISHEDGOODSINVENTORY_DIVISION = '입고' 
GROUP BY 
	FINISHEDGOODSINVENTORY_STORAGE, FINISHEDGOODSINVENTORY_GOODS_ID
ORDER BY 
	FINISHEDGOODSINVENTORY_STORAGE
;

SELECT SUM(FINISHEDGOODSINVENTORY_QUANTITY) AS finishedgoodsinventory_quantity
FROM FINISHEDGOODSINVENTORY j
WHERE FINISHEDGOODSINVENTORY_DIVISION = '출고'
AND j.FINISHEDGOODSINVENTORY_ID = 
GROUP BY FINISHEDGOODSINVENTORY_STORAGE, FINISHEDGOODSINVENTORY_GOODS_ID;

SELECT FINISHEDGOODSINVENTORY_STORAGE FROM FINISHEDGOODSINVENTORY;

--남은 수량 구하기
SELECT FINISHEDGOODSINVENTORY_GOODS_ID, FINISHEDGOODSINVENTORY_STORAGE ,sum(FINISHEDGOODSINVENTORY_QUANTITY) 
FROM FINISHEDGOODSINVENTORY f 
WHERE FINISHEDGOODSINVENTORY_DIVISION = '입고' 
GROUP BY FINISHEDGOODSINVENTORY_GOODS_ID, FINISHEDGOODSINVENTORY_STORAGE
;

SELECT FINISHEDGOODSINVENTORY_GOODS_ID, FINISHEDGOODSINVENTORY_STORAGE,sum(FINISHEDGOODSINVENTORY_QUANTITY) 
FROM FINISHEDGOODSINVENTORY f 
WHERE FINISHEDGOODSINVENTORY_DIVISION = '출고' 
GROUP BY FINISHEDGOODSINVENTORY_GOODS_ID, FINISHEDGOODSINVENTORY_STORAGE;

UPDATE FINISHEDGOODS 
SET FINISHEDGOODS_QUANTITY = 500 
WHERE FINISHEDGOODS_ID = 100;

